Sub stocks():    Dim lastRow As Long    Dim ticker_row As Long    Dim i As Long    Dim first_open As Double    Dim last_close As Double    Dim yearly_change As Double    Dim max_increase As Double    Dim max_decrease As Double    Dim yearly_change_prc As Double    Dim stock_total As LongLong    Dim max_volume As LongLong    Dim max_increase_ticker As String    Dim max_decrease_ticker As String    Dim max_volume_ticker As String    Dim ws As Worksheet    For Each ws In Worksheets        ws.Cells(1, 9).Value = "Ticker"        ws.Cells(1, 10).Value = "Yearly Change"        ws.Cells(1, 11).Value = "Percent Change"        ws.Cells(1, 12).Value = "Total Stock Volume"        ws.Cells(1, 16).Value = "Ticker"        ws.Cells(1, 17).Value = "Value"        ws.Cells(2, 15).Value = "Greatest % Increase"        ws.Cells(3, 15).Value = "Greatest % Decrease"        ws.Cells(4, 15).Value = "Greatest Total Volume"        ticker_row = 2        stock_total = 0        max_increase = 0        max_decrease = 0        max_volume = 0        lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row        ' Initialize the first_open for the first ticker        first_open = ws.Cells(2, 3).Value        For i = 2 To lastRow            ' Check if the ticker changes            If ws.Cells(i, 1).Value <> ws.Cells(i + 1, 1).Value Then                ' Set the ticker name                ws.Cells(ticker_row, 9).Value = ws.Cells(i, 1).Value                ' Set the closing price for the ticker                last_close = ws.Cells(i, 6).Value                ' Calculate the yearly change                yearly_change = last_close - first_open                ws.Cells(ticker_row, 10).Value = yearly_change                ' Calculate the percent change                yearly_change_prc = yearly_change / first_open                ws.Cells(ticker_row, 11).Value = yearly_change_prc                ws.Cells(ticker_row, 11).NumberFormat = "0.00%"                ' Calculate total stock volume                stock_total = stock_total + ws.Cells(i, 7).Value                ' Set the location of the stock total volume                ws.Cells(ticker_row, 12).Value = stock_total                                ' Apply conditional formatting                If yearly_change < 0 Then                    ws.Cells(ticker_row, 10).Interior.Color = RGB(255, 0, 0) ' Red for negative change                ElseIf yearly_change > 0 Then                    ws.Cells(ticker_row, 10).Interior.Color = RGB(0, 255, 0) ' Green for positive change                End If                                ' Check for greatest total volume                If stock_total > max_volume Then                    max_volume = stock_total                    max_volume_ticker = ws.Cells(i, 1).Value                End If                ' Check for greatest % increase                If yearly_change_prc > max_increase Then                    max_increase = yearly_change_prc                    max_increase_ticker = ws.Cells(i, 1).Value                End If                ' Check for greatest % decrease                If yearly_change_prc < max_decrease Then                    max_decrease = yearly_change_prc                    max_decrease_ticker = ws.Cells(i, 1).Value                End If                ' Update the ticker row for the next ticker                ticker_row = ticker_row + 1                ' Reset the stock total for the next ticker                stock_total = 0                ' Reset the first_open for the next ticker                If i < lastRow Then                    first_open = ws.Cells(i + 1, 3).Value                End If            Else                ' Accumulate the stock volume for the current ticker                stock_total = stock_total + ws.Cells(i, 7).Value            End If        Next i        ' Print greatest % increase, % decrease, and total volume        ws.Cells(2, 16).Value = max_increase_ticker        ws.Cells(2, 17).Value = max_increase        ws.Cells(2, 17).NumberFormat = "0.00%"        ws.Cells(3, 16).Value = max_decrease_ticker        ws.Cells(3, 17).Value = max_decrease        ws.Cells(3, 17).NumberFormat = "0.00%"        ws.Cells(4, 16).Value = max_volume_ticker        ws.Cells(4, 17).Value = max_volume    Next wsEnd Sub